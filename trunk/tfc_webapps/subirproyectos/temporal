from suds.client import Client
from suds.wsse import *
from datetime import datetime, timedelta



def handle_uploaded_file(f):
    #autentificacion
    d = dict(https='localhost:1080/')
    

    url = 'http://localhost:8080/alfresco/wsdl/authentication-service.wsdl'
    client = Client(url)
    client.set_options(proxy=d)
    login_res = client.service.startSession("admin", "admin")
    print login_res    
    security = Security()
    token = UsernameToken('admin', login_res['ticket'])
    #token.setcreated(datetime.now())
    #token.setnonce()
    
    timestamp = Timestamp ()


    
    security.tokens.append(timestamp)
    security.tokens.append(token)
    print security


    
    
    
    #servicios
    url1 = 'http://localhost:8080/alfresco/wsdl/repository-service.wsdl'
    client2 = Client(url1)
    client2.set_options(wsse=security)
    #print client
    print client2
    client2.service.createStore('workspace', 'pepe' )
    #mysession = client.service.createSession(login_res)
    #destination = open('name.txt', 'wb+')
    #for chunk in f.chunks():
    #    destination.write(chunk)
    #destination.close()
