(function(a){a.widget("ui.tabbed_formset",a.ui.tabs,{options:{prefix:"",formTemplate:"#empty-form"},_create:function(){var b=this;b.formTemplate=a(b.options.formTemplate);b.formTemplate.remove();var c=b.element.find("ol, ul").children("li:has(a[href])");c.each(function(){var c=a(this).find("a[href]").attr("href");b.element.find(c).each(function(){b._hideDeleteCheckbox(a(this))})});var d=b.options.prefix;b.formCounter=a("#id_"+d+"-TOTAL_FORMS").val();var e=b.options.add;b.options.add=function(a,c){b._addHandler(a,c,e)};var f=b.options.remove;b.options.remove=function(a,c){b._removeHandler(a,c,f)};a.ui.tabs.prototype._create.call(this)},_addHandler:function(b,c,d){var e=this.options.prefix;var f=this.formTemplate.clone(true).removeAttr("id");this._updateFormIndexes(f,e,this.formCounter);this._hideDeleteCheckbox(f);a(c.panel).append(f);a("#id_"+e+"-TOTAL_FORMS").val(++this.formCounter);if(d!==null){d.call(b,c)}},_removeHandler:function(b,c,d){var e=a(c.panel).clone(true).hide();var f=e.find('input:hidden[id $= "-DELETE"]');f.val("on");this.element.after(e);if(d!==null){d.call(b,c)}},_hideDeleteCheckbox:function(a){var b=a.find('input:checkbox[id $= "-DELETE"]');if(b.is(":checked")){var c=a.clone(true).hide();b=c.find('input:checkbox[id $= "-DELETE"]');b.before('<input type="hidden" name="'+b.attr("name")+'" id="'+b.attr("id")+'" value="on" />');this.element.after(c);this.element.find("ol, ul").children("li:has(a[href='#"+a.attr("id")+"'])").remove();a.remove()}else{b.before('<input type="hidden" name="'+b.attr("name")+'" id="'+b.attr("id")+'" />');a.find('label[for="'+b.attr("id")+'"]').hide()}b.remove()},_updateElementIndex:function(a,b,c){var d=new RegExp(b+"-__prefix__-");var e=b+"-"+c+"-";if(a.attr("for"))a.attr("for",a.attr("for").replace(d,e));if(a.attr("id"))a.attr("id",a.attr("id").replace(d,e));if(a.attr("name"))a.attr("name",a.attr("name").replace(d,e))},_updateFormIndexes:function(b,c,d){var e="input,select,textarea,label,div";var f=this;b.find(e).each(function(){f._updateElementIndex(a(this),c,d)})}})})(jQuery)